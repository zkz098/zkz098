const CONFIG={version:"0.0.1",hostname:"https://www.kaitaku.xyz",root:"/",statics:"/",favicon:{normal:"undefined/favicon.ico",hidden:"undefined/failure.ico"},darkmode:!1,auto_dark:{enable:!0,start:20,end:7},auto_scroll:!0,js:{chart:"npm/frappe-charts@1.5.0/dist/frappe-charts.min.iife.min.js",copy_tex:"npm/katex@0.12.0/dist/contrib/copy-tex.min.js",fancybox:"combine/npm/jquery@3.5.1/dist/jquery.min.js,npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js,npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js"},css:{valine:"css/comment.css",katex:"npm/katex@0.12.0/dist/katex.min.css",mermaid:"css/mermaid.css",fancybox:"combine/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"},loader:{start:!0,switch:!1},search:{appID:"Z90S0X07N8",apiKey:"8770deb4853046c6fb7f786f02ab69be",indexName:"kaitaku-blog",hits:{per_page:10}},quicklink:{timeout:3e3,priority:!0},audio:[{title:"列表1",list:["https://music.163.com/#/playlist?id=2943811283","https://music.163.com/#/playlist?id=2297706586"]},{title:"列表2",list:["https://music.163.com/#/playlist?id=2031842656"]}],fireworks:["rgba(255,182,185,.9)","rgba(250,227,217,.9)","rgba(187,222,214,.9)","rgba(138,198,209,.9)"]},getDocHeight=()=>$dom("main > .inner").offsetHeight,$dom=(e,t=document)=>0===e.indexOf("#")?t.getElementById(e.replace("#","")):t.querySelector(e),$storage=($dom.all=(e,t=document)=>t.querySelectorAll(e),$dom.each=(e,t,n)=>$dom.all(e,n).forEach(t),Object.assign(HTMLElement.prototype,{createChild:function(e,t,n){var a=document.createElement(e);switch(Object.assign(a,t),n){case"after":this.insertAfter(a);break;case"replace":this.innerHTML="",this.appendChild(a);break;default:this.appendChild(a)}return a},wrap:function(e){const t=document.createElement("div");Object.assign(t,e),this.parentNode.insertBefore(t,this),this.parentNode.removeChild(this),t.appendChild(this)},height:function(e){return e&&(this.style.height="number"==typeof e?e+"rem":e),this.getBoundingClientRect().height},width:function(e){return e&&(this.style.width="number"==typeof e?e+"rem":e),this.getBoundingClientRect().width},top:function(){return this.getBoundingClientRect().top},left:function(){return this.getBoundingClientRect().left},attr:function(e,t){return null===t?this.removeAttribute(e):t?(this.setAttribute(e,t),this):this.getAttribute(e)},insertAfter:function(e){const t=this.parentNode;t.lastChild===this?t.appendChild(e):t.insertBefore(e,this.nextSibling)},display:function(e){return null==e?this.style.display:(this.style.display=e,this)},child:function(e){return $dom(e,this)},find:function(e){return $dom.all(e,this)},_class:function(t,e,n){const a=e.indexOf(" ")?e.split(" "):[e],i=this;a.forEach(function(e){"toggle"===t?i.classList.toggle(e,n):i.classList[t](e)})},addClass:function(e){return this._class("add",e),this},removeClass:function(e){return this._class("remove",e),this},toggleClass:function(e,t){return this._class("toggle",e,t),this},hasClass:function(e){return this.classList.contains(e)}}),{set:(e,t)=>{localStorage.setItem(e,t)},get:e=>localStorage.getItem(e),del:e=>{localStorage.removeItem(e)}}),getScript=function(e,a,t){if(t)a();else{let n=document.createElement("script");n.onload=function(e,t){!t&&n.readyState&&!/loaded|complete/.test(n.readyState)||(n.onload=null,n=void 0,!t&&a&&setTimeout(a,0))},n.src=e,document.head.appendChild(n)}},assetUrl=function(e,t){const n=CONFIG[e][t];return-1<n.indexOf("npm")?"https://unpkg.com/"+n:-1<n.indexOf("gh")||-1<n.indexOf("combine")?"https://cdn.jsdelivr.net/"+n:-1<n.indexOf("http")?n:"/"+n},vendorJs=function(e,t,n){LOCAL[e]&&getScript(assetUrl("js",e),t||function(){window[e]=!0},n||window[e])},vendorCss=function(e,t){window["css"+e]||LOCAL[e]&&(document.head.createChild("link",{rel:"stylesheet",href:assetUrl("css",e)}),window["css"+e]=!0)},transition=(t,e,n)=>{let a,i="none";switch(e){case 0:a={opacity:[1,0]};break;case 1:a={opacity:[0,1]},i="block";break;case"bounceUpIn":a={begin:function(e){t.display("block")},translateY:[{value:-60,duration:200},{value:10,duration:200},{value:-5,duration:200},{value:0,duration:200}],opacity:[0,1]},i="block";break;case"shrinkIn":a={begin:function(e){t.display("block")},scale:[{value:1.1,duration:300},{value:1,duration:200}],opacity:1},i="block";break;case"slideRightIn":a={begin:function(e){t.display("block")},translateX:[100,0],opacity:[0,1]},i="block";break;case"slideRightOut":a={translateX:[0,100],opacity:[1,0]};break;default:a=e,i=e.display}anime(Object.assign({targets:t,duration:200,easing:"linear"},a)).finished.then(function(){t.display(i),n&&n()})},pjaxScript=function(e){var t=e.text||e.textContent||e.innerHTML||"";const n=e.parentNode,a=(n.removeChild(e),document.createElement("script"));e.id&&(a.id=e.id),e.className&&(a.className=e.className),e.type&&(a.type=e.type),e.src&&(a.src=e.src,a.async=!1),void 0!==e.dataset.pjax&&(a.dataset.pjax=""),""!==t&&a.appendChild(document.createTextNode(t)),n.appendChild(a)},pageScroll=function(e,t,n){t={targets:"number"==typeof t?e.parentNode:document.scrollingElement,duration:500,easing:"easeInOutQuad",scrollTop:t||("number"==typeof e?e:e?e.top()+document.documentElement.scrollTop-siteNavHeight:0),complete:function(){n&&n()}};anime(t)},statics=0<CONFIG.statics.indexOf("//")?CONFIG.statics:CONFIG.root,scrollAction={x:void 0,y:void 0};let diffY=0,originTitle,titleTime;const BODY=document.getElementsByTagName("body")[0],HTML=document.documentElement,Container=$dom("#container"),loadCat=$dom("#loading"),siteNav=$dom("#nav"),siteHeader=$dom("#header"),menuToggle=siteNav.child(".toggle"),quickBtn=$dom("#quick"),sideBar=$dom("#sidebar"),siteBrand=$dom("#brand");let toolBtn=$dom("#tool"),toolPlayer,backToTop,goToComment,showContents,siteSearch=$dom("#search"),siteNavHeight,headerHightInner,headerHight,oWinHeight=window.innerHeight,oWinWidth=window.innerWidth,LOCAL_HASH=0,LOCAL_URL=window.location.href,pjax;const changeTheme=function(e){const t=$dom(".theme .ic");"dark"===e?(HTML.attr("data-theme",e),t.removeClass("i-sun"),t.addClass("i-moon")):(HTML.attr("data-theme",null),t.removeClass("i-moon"),t.addClass("i-sun"))},autoDarkmode=function(){CONFIG.auto_dark.enable&&((new Date).getHours()>=CONFIG.auto_dark.start||(new Date).getHours()<=CONFIG.auto_dark.end||window.matchMedia("(prefers-color-scheme:dark)").matches?changeTheme("dark"):changeTheme())},lazyload=lozad("img, [data-background-image]",{loaded:function(e){e.addClass("lozaded")}}),Loader={timer:null,lock:!1,show:function(){clearTimeout(this.timer),document.body.removeClass("loaded"),loadCat.attr("style","display:block"),Loader.lock=!1},hide:function(e){CONFIG.loader.start||(e=-1),this.timer=setTimeout(this.vanish,e||3e3)},vanish:function(){Loader.lock||(CONFIG.loader.start&&transition(loadCat,0),document.body.addClass("loaded"),Loader.lock=!0)}},changeMetaTheme=function(e){"dark"===HTML.attr("data-theme")&&(e="#222"),$dom('meta[name="theme-color"]').attr("content",e)},themeColorListener=function(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",function(e){e.matches?changeTheme("dark"):changeTheme()});var e=$storage.get("theme");e?changeTheme(e):CONFIG.darkmode&&changeTheme("dark"),$dom(".theme").addEventListener("click",function(e){let t;function n(){transition(o,{delay:2500,opacity:0},function(){BODY.removeChild(o)})}const a=e.currentTarget,i=a.child(".ic"),o=BODY.createChild("div",{id:"neko",innerHTML:'<div class="planet"><div class="sun"></div><div class="moon"></div></div><div class="body"><div class="face"><section class="eyes left"><span class="pupil"></span></section><section class="eyes right"><span class="pupil"></span></section><span class="nose"></span></div></div>'});t=i.hasClass("i-sun")?function(){o.addClass("dark"),changeTheme("dark"),$storage.set("theme","dark"),n()}:(o.addClass("dark"),function(){o.removeClass("dark"),changeTheme(),$storage.set("theme","light"),n()}),transition(o,1,function(){setTimeout(t,210)})})},visibilityListener=function(){let e=$dom('[rel="icon"]');document.addEventListener("visibilitychange",function(){switch(document.visibilityState){case"hidden":e.attr("href",statics+CONFIG.favicon.hidden),document.title=LOCAL.favicon.hide,CONFIG.loader.switch&&Loader.show(),clearTimeout(titleTime);break;case"visible":e.attr("href",statics+CONFIG.favicon.normal),document.title=LOCAL.favicon.show,CONFIG.loader.switch&&Loader.hide(1e3),titleTime=setTimeout(function(){document.title=originTitle},2e3)}})},showtip=function(e){if(e){const t=BODY.createChild("div",{innerHTML:e,className:"tip"});setTimeout(function(){t.addClass("hide"),setTimeout(function(){BODY.removeChild(t)},300)},3e3)}},resizeHandle=function(e){siteNavHeight=siteNav.height(),headerHightInner=siteHeader.height(),headerHight=headerHightInner+$dom("#waves").height(),oWinWidth!==window.innerWidth&&sideBarToggleHandle(null,1),oWinHeight=window.innerHeight,oWinWidth=window.innerWidth,sideBar.child(".panels").height(oWinHeight+"px")},scrollHandle=function(e){var t=window.innerHeight,n=getDocHeight(),n=t<n?n-t:document.body.scrollHeight-t,t=window.scrollY>headerHightInner,a=0<window.scrollY,a=(t?changeMetaTheme("#FFF"):changeMetaTheme("#222"),siteNav.toggleClass("show",t),toolBtn.toggleClass("affix",a),siteBrand.toggleClass("affix",a),sideBar.toggleClass("affix",window.scrollY>headerHight&&991<document.body.offsetWidth),void 0===scrollAction.y&&(scrollAction.y=window.scrollY),(diffY=scrollAction.y-window.scrollY)<0?(siteNav.removeClass("up"),siteNav.toggleClass("down",t)):0<diffY&&(siteNav.removeClass("down"),siteNav.toggleClass("up",t)),scrollAction.y=window.scrollY,Math.round(Math.min(100*window.scrollY/n,100))+"%");backToTop.child("span").innerText=a,$dom(".percent").width(a)},pagePosition=function(){CONFIG.auto_scroll&&$storage.set(LOCAL_URL,String(scrollAction.y))},positionInit=function(e){var t,n=window.location.hash;LOCAL_HASH?$storage.del(LOCAL_URL):((t=n?$dom(decodeURI(n)):CONFIG.auto_scroll?parseInt($storage.get(LOCAL_URL)):0)&&(pageScroll(t),LOCAL_HASH=1),e&&n&&!LOCAL_HASH&&(pageScroll(t),LOCAL_HASH=1))},clipBoard=function(e,t){if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(e).then(()=>{t&&t(!0)},()=>{t&&t(!1)});else{const a=BODY.createChild("textarea",{style:{top:window.scrollY+"px",position:"absolute",opacity:"0"},readOnly:!0,value:e}),i=document.getSelection();var n=0<i.rangeCount&&i.getRangeAt(0),e=(a.select(),a.setSelectionRange(0,e.length),a.readOnly=!1,document.execCommand("copy"));t&&t(e),a.blur(),n&&(i.removeAllRanges(),i.addRange(n)),BODY.removeChild(a)}},cardActive=function(){if($dom(".index.wrap")){if(window.IntersectionObserver){const t=new IntersectionObserver(function(e){e.forEach(function(e){e.target.hasClass("show")?t.unobserve(e.target):(e.isIntersecting||0<e.intersectionRatio)&&(e.target.addClass("show"),t.unobserve(e.target))})},{root:null,threshold:[.3]});$dom.each(".index.wrap article.item, .index.wrap section.item",function(e){t.observe(e)}),$dom(".index.wrap .item:first-child").addClass("show")}else $dom.each(".index.wrap article.item, .index.wrap section.item",function(e){!1===e.hasClass("show")&&e.addClass("show")});$dom.each(".cards .item",function(t,e){["mouseenter","touchstart"].forEach(function(e){t.addEventListener(e,function(e){$dom(".cards .item.active")&&$dom(".cards .item.active").removeClass("active"),t.addClass("active")},{passive:!0})}),["mouseleave"].forEach(function(e){t.addEventListener(e,function(e){t.removeClass("active")},{passive:!0})})})}},registerExtURL=function(){$dom.each("span.exturl",function(e){const t=document.createElement("a");t.href=decodeURIComponent(atob(e.dataset.url).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")),t.rel="noopener external nofollow noreferrer",t.target="_blank",t.className=e.className,t.title=e.title||e.innerText,t.innerHTML=e.innerHTML,e.dataset.backgroundImage&&(t.dataset.backgroundImage=e.dataset.backgroundImage),e.parentNode.replaceChild(t,e)})},postFancybox=function(e){$dom(e+" .md img")&&(vendorCss("fancybox"),vendorJs("fancybox",function(){const s=jQuery.noConflict();$dom.each(e+" p.gallery",function(e){const t=document.createElement("div");t.className="gallery",t.attr("data-height",e.attr("data-height")||220),t.innerHTML=e.innerHTML.replace(/<br>/g,""),e.parentNode.insertBefore(t,e),e.remove()}),$dom.each(e+" .md img:not(.emoji):not(.vemoji)",function(e){const t=s(e);var n=t.attr("data-src")||t.attr("src");const a=t.wrap('<a class="fancybox" href="'+n+'" itemscope itemtype="https://schema.org/ImageObject" itemprop="url"></a>').parent("a");let i="image-info";if(t.is("a img")||(t.data("safe-src",n),t.is(".gallery img")?i="jg-caption":a.attr("data-fancybox","default").attr("rel","default")),n=e.attr("title")){a.attr("data-caption",n);const o=document.createElement("span");n=document.createTextNode(n);o.appendChild(n),o.addClass(i),e.insertAfter(o)}}),$dom.each(e+" div.gallery",function(e,n){s(e).justifiedGallery({rowHeight:s(e).data("height")||120,rel:"gallery-"+n}).on("jg.complete",function(){s(this).find("a").each((e,t)=>{t.attr("data-fancybox","gallery-"+n)})})}),s.fancybox.defaults.hash=!1,s(e+" .fancybox").fancybox({loop:!0,helpers:{overlay:{locked:!1}}})},window.jQuery))},postBeauty=function(){loadComments(),$dom(".md")&&(postFancybox(".post.block"),$dom(".post.block").oncopy=function(e){if(showtip(LOCAL.copyright),LOCAL.nocopy)e.preventDefault();else{const o=$dom("#copyright");if(30<window.getSelection().toString().length&&o){e.preventDefault();var t="# "+o.child(".author").innerText,n="# "+o.child(".link").innerText,a="# "+o.child(".license").innerText,i=t+"<br>"+n+"<br>"+a+"<br><br>"+window.getSelection().toString().replace(/\r\n/g,"<br>"),t=t+"\n"+n+"\n"+a+"\n\n"+window.getSelection().toString().replace(/\r\n/g,"\n");if(e.clipboardData)e.clipboardData.setData("text/html",i),e.clipboardData.setData("text/plain",t);else if(window.clipboardData)return window.clipboardData.setData("text",t)}}},$dom.each("li ruby",function(e){let t=e.parentNode;(t="LI"!==e.parentNode.tagName?e.parentNode.parentNode:t).addClass("ruby")}),$dom.each("ol[start]",function(e){e.style.counterReset="counter "+parseInt(e.attr("start")-1)}),$dom.each(".md table",function(e){e.wrap({className:"table-container"})}),$dom.each(".highlight > .table-container",function(e){e.className="code-container"}),$dom.each("figure.highlight",function(n){const t=function(){i.style.maxHeight="",showBtn.addClass("open")},i=n.child(".code-container"),e=n.child("figcaption"),a=(n.insertAdjacentHTML("beforeend",'<div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div>'),n.child(".copy-btn")),o=(LOCAL.nocopy?a.remove():(a.addEventListener("click",function(e){const t=e.currentTarget;let n="",a="";i.find("pre").forEach(function(e){a+=n+e.innerText,n="\n"}),clipBoard(a,function(e){t.child(".ic").className=e?"ic i-check":"ic i-times",t.blur(),showtip(LOCAL.copyright)})},{passive:!0}),a.addEventListener("mouseleave",function(e){setTimeout(function(){e.target.child(".ic").className="ic i-clipboard"},1e3)})),n.child(".breakline-btn")),s=(o.addEventListener("click",function(e){const t=e.currentTarget;n.hasClass("breakline")?(n.removeClass("breakline"),t.child(".ic").className="ic i-align-left"):(n.addClass("breakline"),t.child(".ic").className="ic i-align-justify")}),n.child(".fullscreen-btn")),c=function(){n.removeClass("fullscreen"),n.scrollTop=0,BODY.removeClass("fullscreen"),s.child(".ic").className="ic i-expand"};function r(e){e.currentTarget,n.hasClass("fullscreen")?(c(),hideCode&&hideCode(),pageScroll(n)):(n.addClass("fullscreen"),BODY.addClass("fullscreen"),s.child(".ic").className="ic i-compress",t&&t())}if(s.addEventListener("click",r),e&&e.addEventListener("click",r),i&&15<i.find("tr").length){i.style.maxHeight="300px",i.insertAdjacentHTML("beforeend",'<div class="show-btn"><i class="ic i-angle-down"></i></div>');const showBtn=i.child(".show-btn"),hideCode=function(){i.style.maxHeight="300px",showBtn.removeClass("open")};showBtn.addEventListener("click",function(e){showBtn.hasClass("open")?(c(),hideCode(),pageScroll(i)):t()})}}),$dom.each("pre.mermaid > svg",function(e){const t=e;t.style.maxWidth=""}),$dom.each(".reward button",function(e){e.addEventListener("click",function(e){e.preventDefault();const t=$dom("#qr");"inline-flex"===t.display()?transition(t,0):transition(t,1,function(){t.display("inline-flex")})})}),$dom.each(".quiz > ul.options li",function(t){t.addEventListener("click",function(e){t.hasClass("correct")?(t.toggleClass("right"),t.parentNode.parentNode.addClass("show")):t.toggleClass("wrong")})}),$dom.each(".quiz > p",function(t){t.addEventListener("click",function(e){t.parentNode.toggleClass("show")})}),$dom.each(".quiz > p:first-child",function(e){const t=e.parentNode;let n="choice";(t.hasClass("true")||t.hasClass("false"))&&(n="true_false"),t.hasClass("multi")&&(n="multiple"),t.hasClass("fill")&&(n="gap_fill"),t.hasClass("essay")&&(n="essay"),e.attr("data-type",LOCAL.quiz[n])}),$dom.each(".quiz .mistake",function(e){e.attr("data-type",LOCAL.quiz.mistake)}),$dom.each("div.tags a",function(e){e.className=["primary","success","info","warning","danger"][Math.floor(5*Math.random())]}),$dom.each(".md div.player",function(e){mediaPlayer(e,{type:e.attr("data-type"),mode:"order",btns:[]}).player.load(JSON.parse(e.attr("data-src"))).fetch()}))},tabFormat=function(){let c;$dom.each("div.tab",function(a,e){if(!a.attr("data-ready")){var t=a.attr("data-id"),i=a.attr("data-title");let n=$dom("#"+t);if(n)c=!1;else{(n=document.createElement("div")).className="tabs",n.id=t,n.innerHTML='<div class="show-btn"></div>';const s=n.child(".show-btn");s.addEventListener("click",function(e){pageScroll(n)}),a.parentNode.insertBefore(n,a),c=!0}let e=n.child(".nav ul");const o=(e=e||n.createChild("div",{className:"nav",innerHTML:"<ul></ul>"}).child("ul")).createChild("li",{innerHTML:i});c&&(o.addClass("active"),a.addClass("active")),o.addEventListener("click",function(e){const t=e.currentTarget;n.find(".active").forEach(function(e){e.removeClass("active")}),a.addClass("active"),t.addClass("active")}),n.appendChild(a),a.attr("data-ready",!0)}})},loadComments=function(){var e=$dom("#comments");if(e)if(goToComment.display(""),window.IntersectionObserver){const t=new IntersectionObserver(function(e,t){e=e[0];vendorCss("valine"),(e.isIntersecting||0<e.intersectionRatio)&&(transition($dom("#comments"),"bounceUpIn"),t.disconnect())});t.observe(e)}else vendorCss("valine");else goToComment.display("none")},algoliaSearch=function(e){if(null!==CONFIG.search){siteSearch=siteSearch||BODY.createChild("div",{id:"search",innerHTML:'<div class="inner"><div class="header"><span class="icon"><i class="ic i-search"></i></span><div class="search-input-container"></div><span class="close-btn"><i class="ic i-times-circle"></i></span></div><div class="results"><div class="inner"><div id="search-stats"></div><div id="search-hits"></div><div id="search-pagination"></div></div></div></div>'});const t=instantsearch({indexName:CONFIG.search.indexName,searchClient:algoliasearch(CONFIG.search.appID,CONFIG.search.apiKey),searchFunction:function(e){$dom(".search-input").value&&e.search()}}),n=(t.on("render",function(){e.refresh($dom("#search-hits"))}),t.addWidgets([instantsearch.widgets.configure({hitsPerPage:CONFIG.search.hits.per_page||10}),instantsearch.widgets.searchBox({container:".search-input-container",placeholder:LOCAL.search.placeholder,showReset:!1,showSubmit:!1,showLoadingIndicator:!1,cssClasses:{input:"search-input"}}),instantsearch.widgets.stats({container:"#search-stats",templates:{text:function(e){return LOCAL.search.stats.replace(/\$\{hits}/,e.nbHits).replace(/\$\{time}/,e.processingTimeMS)+'<span class="algolia-powered"></span><hr>'}}}),instantsearch.widgets.hits({container:"#search-hits",templates:{item:function(e){var t=e.categories?"<span>"+e.categories.join('<i class="ic i-angle-right"></i>')+"</span>":"";return'<a href="'+CONFIG.root+e.path+'">'+t+e._highlightResult.title.value+"</a>"},empty:function(e){return'<div id="hits-empty">'+LOCAL.search.empty.replace(/\$\{query}/,e.query)+"</div>"}},cssClasses:{item:"item"}}),instantsearch.widgets.pagination({container:"#search-pagination",scrollTo:!1,showFirst:!1,showLast:!1,templates:{first:'<i class="ic i-angle-double-left"></i>',last:'<i class="ic i-angle-double-right"></i>',previous:'<i class="ic i-angle-left"></i>',next:'<i class="ic i-angle-right"></i>'},cssClasses:{root:"pagination",item:"pagination-item",link:"page-number",selectedItem:"current",disabledItem:"disabled-item"}})]),t.start(),$dom.each(".search",function(e){e.addEventListener("click",function(){document.body.style.overflow="hidden",transition(siteSearch,"shrinkIn",function(){$dom(".search-input").focus()})})}),function(){document.body.style.overflow="",transition(siteSearch,0)});siteSearch.addEventListener("click",function(e){e.target===siteSearch&&n()}),$dom(".close-btn").addEventListener("click",n),window.addEventListener("pjax:success",n),window.addEventListener("keyup",function(e){"Escape"===e.key&&n()})}},domInit=function(){$dom.each(".overview .menu > .item",function(e){siteNav.child(".menu").appendChild(e.cloneNode(!0))}),loadCat.addEventListener("click",Loader.vanish),menuToggle.addEventListener("click",sideBarToggleHandle),$dom(".dimmer").addEventListener("click",sideBarToggleHandle),quickBtn.child(".down").addEventListener("click",goToBottomHandle),quickBtn.child(".up").addEventListener("click",backToTopHandle),toolBtn=toolBtn||siteHeader.createChild("div",{id:"tool",innerHTML:'<div class="item player"></div><div class="item contents"><i class="ic i-list-ol"></i></div><div class="item chat"><i class="ic i-comments"></i></div><div class="item back-to-top"><i class="ic i-arrow-up"></i><span>0%</span></div>'}),toolPlayer=toolBtn.child(".player"),backToTop=toolBtn.child(".back-to-top"),goToComment=toolBtn.child(".chat"),showContents=toolBtn.child(".contents"),backToTop.addEventListener("click",backToTopHandle),goToComment.addEventListener("click",goToCommentHandle),showContents.addEventListener("click",sideBarToggleHandle),"undefined"!=typeof mediaPlayer&&(mediaPlayer(toolPlayer),$dom("main").addEventListener("click",function(){toolPlayer.player.mini()}))},pjaxReload=function(){pagePosition(),sideBar.hasClass("on")&&transition(sideBar,function(){sideBar.removeClass("on"),menuToggle.removeClass("close")});let e=$dom("#main");e.innerHTML="",e.appendChild(loadCat.lastChild.cloneNode(!0)),pageScroll(0)},siteRefresh=function(e){LOCAL_HASH=0,LOCAL_URL=window.location.href,vendorCss("katex"),vendorJs("copy_tex"),vendorCss("mermaid"),vendorJs("chart"),e||$dom.each("script[data-pjax]",pjaxScript),originTitle=document.title,resizeHandle(),menuActive(),sideBarTab(),sidebarTOC(),registerExtURL(),postBeauty(),tabFormat(),"undefined"!=typeof mediaPlayer&&toolPlayer.player.load(LOCAL.audio||CONFIG.audio||{}),Loader.hide(),setTimeout(function(){positionInit()},500),cardActive(),lazyload.observe()},siteInit=function(){domInit(),pjax=new Pjax({selectors:["head title",".languages",".twikoo",".pjax",".leancloud-recent-comment","script[data-config]"],analytics:!1,cacheBust:!1}),CONFIG.quicklink.ignores=LOCAL.ignores,quicklink.listen(CONFIG.quicklink),autoDarkmode(),visibilityListener(),themeColorListener(),algoliaSearch(pjax),window.addEventListener("scroll",scrollHandle),window.addEventListener("resize",resizeHandle),window.addEventListener("pjax:send",pjaxReload),window.addEventListener("pjax:success",siteRefresh),window.addEventListener("beforeunload",function(){pagePosition()}),siteRefresh(1)},canvasEl=(window.addEventListener("DOMContentLoaded",siteInit),console.log("%c Theme.ShokaX v"+CONFIG.version+" %c https://github.com/zkz098/hexo-theme-shokaX ","color: white; background: #e9546b; padding:5px 0;","padding:4px;border:1px solid #e9546b;"),console.log("%c by kaitaku %c https://www.kaitaku.xyz","color: white; background: #00bfff; padding: 5px 3px;","padding: 4px;border:1px solid #00bfff"),document.createElement("canvas")),ctx=(canvasEl.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:9999999",document.body.appendChild(canvasEl),canvasEl.getContext("2d")),numberOfParticules=30;let pointerX=0,pointerY=0;const tap="click",colors=CONFIG.fireworks;function setCanvasSize(){canvasEl.width=2*window.innerWidth,canvasEl.height=2*window.innerHeight,canvasEl.style.width=window.innerWidth+"px",canvasEl.style.height=window.innerHeight+"px",canvasEl.getContext("2d").scale(2,2)}function updateCoords(e){pointerX=e.clientX||e.touches&&e.touches[0].clientX,pointerY=e.clientY||e.touches&&e.touches[0].clientY}function setParticuleDirection(e){var t=anime.random(0,360)*Math.PI/180,n=anime.random(50,180),n=[-1,1][anime.random(0,1)]*n;return{x:e.x+n*Math.cos(t),y:e.y+n*Math.sin(t)}}function createParticule(e,t){const n={x:void 0,y:void 0,color:void 0,radius:void 0,endPos:void 0,draw:void 0};return n.x=e,n.y=t,n.color=colors[anime.random(0,colors.length-1)],n.radius=anime.random(16,32),n.endPos=setParticuleDirection(n),n.draw=function(){ctx.beginPath(),ctx.arc(n.x,n.y,n.radius,0,2*Math.PI,!0),ctx.fillStyle=n.color,ctx.fill()},n}function createCircle(e,t){const n={x:void 0,y:void 0,color:void 0,radius:void 0,endPos:void 0,alpha:void 0,lineWidth:void 0,draw:void 0};return n.x=e,n.y=t,n.color="#FFF",n.radius=.1,n.alpha=.5,n.lineWidth=6,n.draw=function(){ctx.globalAlpha=n.alpha,ctx.beginPath(),ctx.arc(n.x,n.y,n.radius,0,2*Math.PI,!0),ctx.lineWidth=n.lineWidth,ctx.strokeStyle=n.color,ctx.stroke(),ctx.globalAlpha=1},n}function renderParticule(t){for(let e=0;e<t.animatables.length;e++)t.animatables[e].target.draw()}function animateParticules(t,n){var e=createCircle(t,n);const a=[];for(let e=0;e<numberOfParticules;e++)a.push(createParticule(t,n));anime.timeline().add({targets:a,x:function(e){return e.endPos.x},y:function(e){return e.endPos.y},radius:.1,duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule}).add({targets:e,radius:anime.random(80,160),lineWidth:0,alpha:{value:0,easing:"linear",duration:anime.random(600,800)},duration:anime.random(1200,1800),easing:"easeOutExpo",update:renderParticule},0)}const render=anime({duration:1/0,update:function(){ctx.clearRect(0,0,canvasEl.width,canvasEl.height)}}),sideBarToggleHandle=(document.addEventListener(tap,function(e){render.play(),updateCoords(e),animateParticules(pointerX,pointerY)},!1),setCanvasSize(),window.addEventListener("resize",setCanvasSize,!1),function(e,t){sideBar.hasClass("on")?(sideBar.removeClass("on"),menuToggle.removeClass("close"),t?sideBar.style="":transition(sideBar,"slideRightOut")):t?sideBar.style="":transition(sideBar,"slideRightIn",function(){sideBar.addClass("on"),menuToggle.addClass("close")})}),sideBarTab=function(){const e=sideBar.child(".inner"),o=(sideBar.find(".panel"),sideBar.child(".tab")&&e.removeChild(sideBar.child(".tab")),document.createElement("ul"));let s="active";o.className="tab",["contents","related","overview"].forEach(function(e){const t=sideBar.child(".panel."+e);if(t.innerHTML.replace(/(^\s*)|(\s*$)/g,"").length<1)"contents"===e&&showContents.display("none");else{"contents"===e&&showContents.display("");const a=document.createElement("li"),i=document.createElement("span");var n=document.createTextNode(t.attr("data-title"));i.appendChild(n),a.appendChild(i),a.addClass(e+" item"),s?(t.addClass(s),a.addClass(s)):t.removeClass("active"),a.addEventListener("click",function(e){const t=e.currentTarget;t.hasClass("active")||(sideBar.find(".tab .item").forEach(function(e){e.removeClass("active")}),sideBar.find(".panel").forEach(function(e){e.removeClass("active")}),sideBar.child(".panel."+t.className.replace(" item","")).addClass("active"),t.addClass("active"))}),o.appendChild(a),s=""}}),1<o.childNodes.length?(e.insertBefore(o,e.childNodes[0]),sideBar.child(".panels").style.paddingTop=""):sideBar.child(".panels").style.paddingTop=".625rem"},sidebarTOC=function(){function s(t){const n=e[t];if(n&&!n.hasClass("current")){$dom.each(".toc .active",function(e){e&&e.removeClass("active current")}),i.forEach(function(e){e&&e.removeClass("active")}),n.addClass("active current"),i[t]&&i[t].addClass("active");let e=n.parentNode;for(;!e.matches(".contents");){if(e.matches("li")){e.addClass("active");const a=$dom(e.child("a.toc-link").attr("href"));a&&a.addClass("active")}e=e.parentNode}"none"!==getComputedStyle(sideBar).display&&o.hasClass("active")&&pageScroll(o,n.offsetTop-o.offsetHeight/4)}}const e=$dom.all(".contents li");if(e.length<1)return;let i=Array.prototype.slice.call(e)||[],c=null;i=i.map(function(e,t){const n=e.child("a.toc-link"),a=$dom(decodeURI(n.attr("href")));if(a){const i=a.child("a.anchor"),o=function(e){e.preventDefault();e=$dom(decodeURI(e.currentTarget.attr("href")));c=t,pageScroll(e,null,function(){s(t),c=null})};return n.addEventListener("click",o),i&&i.addEventListener("click",function(e){o(e),clipBoard(CONFIG.hostname+"/"+LOCAL.path+e.currentTarget.attr("href"))}),a}});const o=sideBar.child(".contents.panel");if(window.IntersectionObserver){const t=new IntersectionObserver(function(e,t){e=function(e){let t=0,n=e[t];if(0<n.boundingClientRect.top)return 0===(t=i.indexOf(n.target))?0:t-1;for(;t<e.length;t++){if(!(e[t].boundingClientRect.top<=0))return i.indexOf(n.target);n=e[t]}return i.indexOf(n.target)}(e)+(diffY<0?1:0);null===c&&s(e)},{rootMargin:"0px 0px -100% 0px",threshold:0});i.forEach(function(e){e&&t.observe(e)})}},backToTopHandle=function(){pageScroll(0)},goToBottomHandle=function(){pageScroll(parseInt(String(Container.height())))},goToCommentHandle=function(){pageScroll($dom("#comments"))},menuActive=function(){$dom.each(".menu .item:not(.title)",function(e){var t,n,a=e.child("a[href]");const i=e.parentNode.parentNode;a&&(t=a.pathname===location.pathname||a.pathname===location.pathname.replace("index.html",""),n=!CONFIG.root.startsWith(a.pathname)&&location.pathname.startsWith(a.pathname),a=a.hostname===location.hostname&&(t||n),e.toggleClass("active",a),e.parentNode.child(".active")&&i.hasClass("dropdown")?i.removeClass("active").addClass("expand"):i.removeClass("expand"))})};