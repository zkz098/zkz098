const cardActive=function(){if($dom(".index.wrap")){if(window.IntersectionObserver){const t=new IntersectionObserver(function(e){e.forEach(function(e){e.target.hasClass("show")?t.unobserve(e.target):(e.isIntersecting||0<e.intersectionRatio)&&(e.target.addClass("show"),t.unobserve(e.target))})},{root:null,threshold:[.3]});$dom.each(".index.wrap article.item, .index.wrap section.item",function(e){t.observe(e)}),$dom(".index.wrap .item:first-child").addClass("show")}else $dom.each(".index.wrap article.item, .index.wrap section.item",function(e){!1===e.hasClass("show")&&e.addClass("show")});$dom.each(".cards .item",function(t,e){["mouseenter","touchstart"].forEach(function(e){t.addEventListener(e,function(e){$dom(".cards .item.active")&&$dom(".cards .item.active").removeClass("active"),t.addClass("active")},{passive:!0})}),["mouseleave"].forEach(function(e){t.addEventListener(e,function(e){t.removeClass("active")},{passive:!0})})})}},registerExtURL=function(){$dom.each("span.exturl",function(e){const t=document.createElement("a");t.href=decodeURIComponent(atob(e.dataset.url).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join("")),t.rel="noopener external nofollow noreferrer",t.target="_blank",t.className=e.className,t.title=e.title||e.innerText,t.innerHTML=e.innerHTML,e.dataset.backgroundImage&&(t.dataset.backgroundImage=e.dataset.backgroundImage),e.parentNode.replaceChild(t,e)})},postFancybox=function(e){$dom(e+" .md img")&&(vendorCss("fancybox"),vendorJs("fancybox",function(){const o=jQuery.noConflict();$dom.each(e+" p.gallery",function(e){const t=document.createElement("div");t.className="gallery",t.attr("data-height",e.attr("data-height")||220),t.innerHTML=e.innerHTML.replace(/<br>/g,""),e.parentNode.insertBefore(t,e),e.remove()}),$dom.each(e+" .md img:not(.emoji):not(.vemoji)",function(e){const t=o(e);var a=t.attr("data-src")||t.attr("src");const i=t.wrap('<a class="fancybox" href="'+a+'" itemscope itemtype="https://schema.org/ImageObject" itemprop="url"></a>').parent("a");let n="image-info";if(t.is("a img")||(t.data("safe-src",a),t.is(".gallery img")?n="jg-caption":i.attr("data-fancybox","default").attr("rel","default")),a=e.attr("title")){i.attr("data-caption",a);const s=document.createElement("span");a=document.createTextNode(a);s.appendChild(a),s.addClass(n),e.insertAfter(s)}}),$dom.each(e+" div.gallery",function(e,a){o(e).justifiedGallery({rowHeight:o(e).data("height")||120,rel:"gallery-"+a}).on("jg.complete",function(){o(this).find("a").each((e,t)=>{t.attr("data-fancybox","gallery-"+a)})})}),o.fancybox.defaults.hash=!1,o(e+" .fancybox").fancybox({loop:!0,helpers:{overlay:{locked:!1}}})},window.jQuery))},postBeauty=function(){loadComments(),$dom(".md")&&(postFancybox(".post.block"),$dom(".post.block").oncopy=function(e){if(showtip(LOCAL.copyright),LOCAL.nocopy)e.preventDefault();else{const s=$dom("#copyright");if(30<window.getSelection().toString().length&&s){e.preventDefault();var t="# "+s.child(".author").innerText,a="# "+s.child(".link").innerText,i="# "+s.child(".license").innerText,n=t+"<br>"+a+"<br>"+i+"<br><br>"+window.getSelection().toString().replace(/\r\n/g,"<br>"),t=t+"\n"+a+"\n"+i+"\n\n"+window.getSelection().toString().replace(/\r\n/g,"\n");if(e.clipboardData)e.clipboardData.setData("text/html",n),e.clipboardData.setData("text/plain",t);else if(window.clipboardData)return window.clipboardData.setData("text",t)}}},$dom.each("li ruby",function(e){let t=e.parentNode;(t="LI"!==e.parentNode.tagName?e.parentNode.parentNode:t).addClass("ruby")}),$dom.each("ol[start]",function(e){e.style.counterReset="counter "+parseInt(e.attr("start")-1)}),$dom.each(".md table",function(e){e.wrap({className:"table-container"})}),$dom.each(".highlight > .table-container",function(e){e.className="code-container"}),$dom.each("figure.highlight",function(a){const t=function(){n.style.maxHeight="",showBtn.addClass("open")},n=a.child(".code-container"),e=a.child("figcaption"),i=(a.insertAdjacentHTML("beforeend",'<div class="operation"><span class="breakline-btn"><i class="ic i-align-left"></i></span><span class="copy-btn"><i class="ic i-clipboard"></i></span><span class="fullscreen-btn"><i class="ic i-expand"></i></span></div>'),a.child(".copy-btn")),s=(LOCAL.nocopy?i.remove():(i.addEventListener("click",function(e){const t=e.currentTarget;let a="",i="";n.find("pre").forEach(function(e){i+=a+e.innerText,a="\n"}),clipBoard(i,function(e){t.child(".ic").className=e?"ic i-check":"ic i-times",t.blur(),showtip(LOCAL.copyright)})},{passive:!0}),i.addEventListener("mouseleave",function(e){setTimeout(function(){e.target.child(".ic").className="ic i-clipboard"},1e3)})),a.child(".breakline-btn")),o=(s.addEventListener("click",function(e){const t=e.currentTarget;a.hasClass("breakline")?(a.removeClass("breakline"),t.child(".ic").className="ic i-align-left"):(a.addClass("breakline"),t.child(".ic").className="ic i-align-justify")}),a.child(".fullscreen-btn")),c=function(){a.removeClass("fullscreen"),a.scrollTop=0,BODY.removeClass("fullscreen"),o.child(".ic").className="ic i-expand"};function r(e){e.currentTarget,a.hasClass("fullscreen")?(c(),hideCode&&hideCode(),pageScroll(a)):(a.addClass("fullscreen"),BODY.addClass("fullscreen"),o.child(".ic").className="ic i-compress",t&&t())}if(o.addEventListener("click",r),e&&e.addEventListener("click",r),n&&15<n.find("tr").length){n.style.maxHeight="300px",n.insertAdjacentHTML("beforeend",'<div class="show-btn"><i class="ic i-angle-down"></i></div>');const showBtn=n.child(".show-btn"),hideCode=function(){n.style.maxHeight="300px",showBtn.removeClass("open")};showBtn.addEventListener("click",function(e){showBtn.hasClass("open")?(c(),hideCode(),pageScroll(n)):t()})}}),$dom.each("pre.mermaid > svg",function(e){const t=e;t.style.maxWidth=""}),$dom.each(".reward button",function(e){e.addEventListener("click",function(e){e.preventDefault();const t=$dom("#qr");"inline-flex"===t.display()?transition(t,0):transition(t,1,function(){t.display("inline-flex")})})}),$dom.each(".quiz > ul.options li",function(t){t.addEventListener("click",function(e){t.hasClass("correct")?(t.toggleClass("right"),t.parentNode.parentNode.addClass("show")):t.toggleClass("wrong")})}),$dom.each(".quiz > p",function(t){t.addEventListener("click",function(e){t.parentNode.toggleClass("show")})}),$dom.each(".quiz > p:first-child",function(e){const t=e.parentNode;let a="choice";(t.hasClass("true")||t.hasClass("false"))&&(a="true_false"),t.hasClass("multi")&&(a="multiple"),t.hasClass("fill")&&(a="gap_fill"),t.hasClass("essay")&&(a="essay"),e.attr("data-type",LOCAL.quiz[a])}),$dom.each(".quiz .mistake",function(e){e.attr("data-type",LOCAL.quiz.mistake)}),$dom.each("div.tags a",function(e){e.className=["primary","success","info","warning","danger"][Math.floor(5*Math.random())]}),$dom.each(".md div.player",function(e){mediaPlayer(e,{type:e.attr("data-type"),mode:"order",btns:[]}).player.load(JSON.parse(e.attr("data-src"))).fetch()}))},tabFormat=function(){let c;$dom.each("div.tab",function(i,e){if(!i.attr("data-ready")){var t=i.attr("data-id"),n=i.attr("data-title");let a=$dom("#"+t);if(a)c=!1;else{(a=document.createElement("div")).className="tabs",a.id=t,a.innerHTML='<div class="show-btn"></div>';const o=a.child(".show-btn");o.addEventListener("click",function(e){pageScroll(a)}),i.parentNode.insertBefore(a,i),c=!0}let e=a.child(".nav ul");const s=(e=e||a.createChild("div",{className:"nav",innerHTML:"<ul></ul>"}).child("ul")).createChild("li",{innerHTML:n});c&&(s.addClass("active"),i.addClass("active")),s.addEventListener("click",function(e){const t=e.currentTarget;a.find(".active").forEach(function(e){e.removeClass("active")}),i.addClass("active"),t.addClass("active")}),a.appendChild(i),i.attr("data-ready",!0)}})},loadComments=function(){var e=$dom("#comments");if(e)if(goToComment.display(""),window.IntersectionObserver){const t=new IntersectionObserver(function(e,t){e=e[0];vendorCss("valine"),(e.isIntersecting||0<e.intersectionRatio)&&(transition($dom("#comments"),"bounceUpIn"),t.disconnect())});t.observe(e)}else vendorCss("valine");else goToComment.display("none")},algoliaSearch=function(e){if(null!==CONFIG.search){siteSearch=siteSearch||BODY.createChild("div",{id:"search",innerHTML:'<div class="inner"><div class="header"><span class="icon"><i class="ic i-search"></i></span><div class="search-input-container"></div><span class="close-btn"><i class="ic i-times-circle"></i></span></div><div class="results"><div class="inner"><div id="search-stats"></div><div id="search-hits"></div><div id="search-pagination"></div></div></div></div>'});const t=instantsearch({indexName:CONFIG.search.indexName,searchClient:algoliasearch(CONFIG.search.appID,CONFIG.search.apiKey),searchFunction:function(e){$dom(".search-input").value&&e.search()}}),a=(t.on("render",function(){e.refresh($dom("#search-hits"))}),t.addWidgets([instantsearch.widgets.configure({hitsPerPage:CONFIG.search.hits.per_page||10}),instantsearch.widgets.searchBox({container:".search-input-container",placeholder:LOCAL.search.placeholder,showReset:!1,showSubmit:!1,showLoadingIndicator:!1,cssClasses:{input:"search-input"}}),instantsearch.widgets.stats({container:"#search-stats",templates:{text:function(e){return LOCAL.search.stats.replace(/\$\{hits}/,e.nbHits).replace(/\$\{time}/,e.processingTimeMS)+'<span class="algolia-powered"></span><hr>'}}}),instantsearch.widgets.hits({container:"#search-hits",templates:{item:function(e){var t=e.categories?"<span>"+e.categories.join('<i class="ic i-angle-right"></i>')+"</span>":"";return'<a href="'+CONFIG.root+e.path+'">'+t+e._highlightResult.title.value+"</a>"},empty:function(e){return'<div id="hits-empty">'+LOCAL.search.empty.replace(/\$\{query}/,e.query)+"</div>"}},cssClasses:{item:"item"}}),instantsearch.widgets.pagination({container:"#search-pagination",scrollTo:!1,showFirst:!1,showLast:!1,templates:{first:'<i class="ic i-angle-double-left"></i>',last:'<i class="ic i-angle-double-right"></i>',previous:'<i class="ic i-angle-left"></i>',next:'<i class="ic i-angle-right"></i>'},cssClasses:{root:"pagination",item:"pagination-item",link:"page-number",selectedItem:"current",disabledItem:"disabled-item"}})]),t.start(),$dom.each(".search",function(e){e.addEventListener("click",function(){document.body.style.overflow="hidden",transition(siteSearch,"shrinkIn",function(){$dom(".search-input").focus()})})}),function(){document.body.style.overflow="",transition(siteSearch,0)});siteSearch.addEventListener("click",function(e){e.target===siteSearch&&a()}),$dom(".close-btn").addEventListener("click",a),window.addEventListener("pjax:success",a),window.addEventListener("keyup",function(e){"Escape"===e.key&&a()})}},domInit=function(){$dom.each(".overview .menu > .item",function(e){siteNav.child(".menu").appendChild(e.cloneNode(!0))}),loadCat.addEventListener("click",Loader.vanish),menuToggle.addEventListener("click",sideBarToggleHandle),$dom(".dimmer").addEventListener("click",sideBarToggleHandle),quickBtn.child(".down").addEventListener("click",goToBottomHandle),quickBtn.child(".up").addEventListener("click",backToTopHandle),toolBtn=toolBtn||siteHeader.createChild("div",{id:"tool",innerHTML:'<div class="item player"></div><div class="item contents"><i class="ic i-list-ol"></i></div><div class="item chat"><i class="ic i-comments"></i></div><div class="item back-to-top"><i class="ic i-arrow-up"></i><span>0%</span></div>'}),toolPlayer=toolBtn.child(".player"),backToTop=toolBtn.child(".back-to-top"),goToComment=toolBtn.child(".chat"),showContents=toolBtn.child(".contents"),backToTop.addEventListener("click",backToTopHandle),goToComment.addEventListener("click",goToCommentHandle),showContents.addEventListener("click",sideBarToggleHandle),"undefined"!=typeof mediaPlayer&&(mediaPlayer(toolPlayer),$dom("main").addEventListener("click",function(){toolPlayer.player.mini()}))},pjaxReload=function(){pagePosition(),sideBar.hasClass("on")&&transition(sideBar,function(){sideBar.removeClass("on"),menuToggle.removeClass("close")});let e=$dom("#main");e.innerHTML="",e.appendChild(loadCat.lastChild.cloneNode(!0)),pageScroll(0)},siteRefresh=function(e){LOCAL_HASH=0,LOCAL_URL=window.location.href,vendorCss("katex"),vendorJs("copy_tex"),vendorCss("mermaid"),vendorJs("chart"),e||$dom.each("script[data-pjax]",pjaxScript),originTitle=document.title,resizeHandle(),menuActive(),sideBarTab(),sidebarTOC(),registerExtURL(),postBeauty(),tabFormat(),"undefined"!=typeof mediaPlayer&&toolPlayer.player.load(LOCAL.audio||CONFIG.audio||{}),Loader.hide(),setTimeout(function(){positionInit()},500),cardActive(),lazyload.observe()},siteInit=function(){domInit(),pjax=new Pjax({selectors:["head title",".languages",".twikoo",".pjax",".leancloud-recent-comment","script[data-config]"],analytics:!1,cacheBust:!1}),CONFIG.quicklink.ignores=LOCAL.ignores,quicklink.listen(CONFIG.quicklink),autoDarkmode(),visibilityListener(),themeColorListener(),algoliaSearch(pjax),window.addEventListener("scroll",scrollHandle),window.addEventListener("resize",resizeHandle),window.addEventListener("pjax:send",pjaxReload),window.addEventListener("pjax:success",siteRefresh),window.addEventListener("beforeunload",function(){pagePosition()}),siteRefresh(1)};window.addEventListener("DOMContentLoaded",siteInit),console.log("%c Theme.ShokaX v"+CONFIG.version+" %c https://github.com/zkz098/hexo-theme-shokaX ","color: white; background: #e9546b; padding:5px 0;","padding:4px;border:1px solid #e9546b;"),console.log("%c by kaitaku %c https://www.kaitaku.xyz","color: white; background: #00bfff; padding: 5px 3px;","padding: 4px;border:1px solid #00bfff");